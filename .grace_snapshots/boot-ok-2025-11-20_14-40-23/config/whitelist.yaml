# Grace's Whitelist
# Explicitly allowed actions and resources

version: "1.0"

# Approved Actions (Auto-approved based on tier)
approved_actions:
  tier_0_auto_approve:
    - "read_file"
    - "search_memory"
    - "answer_question"
    - "log_event"
    - "generate_suggestion"
    
  tier_1_auto_approve:
    - "create_test_file"
    - "modify_documentation"
    - "add_log_entry"
    - "update_memory"
    - "run_unit_tests"
    
  tier_2_auto_approve:
    - "create_backend_file"
    - "modify_backend_file"
    - "fix_syntax_error"
    - "optimize_code"
    - "generate_tests"
    
  tier_3_auto_approve:
    - "deploy_to_staging"
    - "modify_configuration"
    - "execute_migration"
    - "update_dependencies"

# Approved File Patterns
approved_files:
  backend:
    - "backend/**/*.py"
    - "backend/**/*.md"
    - "tests/**/*.py"
    
  frontend:
    - "frontend/src/**/*.tsx"
    - "frontend/src/**/*.ts"
    - "frontend/src/**/*.css"
    
  config:
    - "config/**/*.yaml"
    - "config/**/*.json"
    
  docs:
    - "docs/**/*.md"
    - "*.md"
    
  scripts:
    - "scripts/**/*.py"
    - "scripts/**/*.sh"

# Approved Modules/Imports
approved_imports:
  standard_library:
    - "asyncio"
    - "json"
    - "typing"
    - "datetime"
    - "pathlib"
    - "logging"
    - "re"
    - "collections"
    
  third_party:
    - "fastapi"
    - "sqlalchemy"
    - "pydantic"
    - "openai"
    - "anthropic"
    
  internal:
    - "backend.*"
    - "config.*"
    - "scripts.*"

# Approved APIs
approved_apis:
  external:
    - endpoint: "https://api.openai.com/v1/*"
      purpose: "LLM generation"
      requires_auth: true
      
    - endpoint: "https://api.anthropic.com/v1/*"
      purpose: "LLM generation"
      requires_auth: true
      
  internal:
    - endpoint: "http://localhost:8000/*"
      purpose: "Grace backend API"
      requires_auth: false

# Approved Commands (Shell/System)
approved_commands:
  development:
    - "python -m pytest"
    - "python -m black"
    - "python -m mypy"
    - "git status"
    - "git log"
    
  monitoring:
    - "ps aux | grep python"
    - "curl http://localhost:8000/health"
    - "cat *.log"
    
  # Commands requiring approval even when whitelisted
  requires_approval:
    - "git commit"
    - "git push"
    - "pip install"
    - "npm install"

# Approved Users/Actors
approved_actors:
  humans:
    - name: "aaron"
      role: "owner"
      approval_required: false
      
  ai_agents:
    - name: "grace"
      role: "autonomous_ai"
      approval_required: true
      
    - name: "grace_code_healer"
      role: "code_fixer"
      approval_required: true
      max_autonomy_tier: 2

# Approved Data Access
approved_data:
  databases:
    - "grace.db"
    - "metrics.db"
    
  tables:
    - "memory"
    - "knowledge"
    - "code_patterns"
    - "conversations"
    
  read_only:
    - "immutable_log"
    - "audit_log"
    - "governance_policy"

# Approved Modifications
approved_modifications:
  low_risk:
    - "add_function"
    - "add_docstring"
    - "fix_typo"
    - "update_comment"
    - "add_type_hint"
    
  medium_risk:
    - "refactor_function"
    - "add_endpoint"
    - "modify_validation"
    - "update_schema"
    
  high_risk:
    - "change_database_schema"
    - "modify_security_settings"
    - "update_governance_rules"
    - "change_api_contract"

# Trust Levels
trust_levels:
  - actor: "aaron"
    level: "full_trust"
    bypass_guardrails: false  # Even owner follows guardrails
    
  - actor: "grace"
    level: "supervised_trust"
    max_tier: 2  # Can operate up to tier 2 autonomy
    
  - actor: "external_api"
    level: "limited_trust"
    max_tier: 0  # Always requires approval

# Update Policy
update_policy:
  whitelist_updates_require:
    - "owner_approval"
    - "parliament_vote"
    - "constitutional_check"
    - "immutable_log_entry"
    
  auto_expire_temporary_approvals: true
  temporary_approval_duration_hours: 24
